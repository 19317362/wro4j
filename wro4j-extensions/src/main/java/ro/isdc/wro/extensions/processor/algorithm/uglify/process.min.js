function HOP(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function is_identifier(a){return/^[a-z_$][a-z0-9_$]*$/i.test(a)&&a!="this"&&!HOP(jsp.KEYWORDS_ATOM,a)&&!HOP(jsp.RESERVED_WORDS,a)&&!HOP(jsp.KEYWORDS,a)}function defaults(a,b){var c={};a===!0&&(a={});for(var d in b)HOP(b,d)&&(c[d]=a&&HOP(a,d)?a[d]:b[d]);return c}function repeat_string(a,b){if(b<=0)return"";if(b==1)return a;var c=repeat_string(a,b>>1);c+=c,b&1&&(c+=a);return c}function split_lines(a,b){var c=[0];jsp.parse(function(){function i(){var a=d.apply(this,arguments);out:{if(f&&f.type=="keyword")break out;if(g(a)>b)switch(a.type){case"keyword":case"atom":case"name":case"punc":h(a);break out}}f=a;return a}function h(a){e=a.pos,c.push(e)}function g(a){return a.pos-e}var d=jsp.tokenizer(a),e=0,f;i.context=function(){return d.context.apply(this,arguments)};return i}());return c.map(function(b,d){return a.substring(b,c[d+1]||a.length)}).join("\n")}function gen_code(a,b){function w(a){var b=a[0],c=n[b];if(!c)throw new Error("Can't find generator for \""+b+'"');v.push(a);var d=c.apply(b,a.slice(1));v.pop();return d}function u(a){var b=a[0],c=a[1];c!=null&&(b=h([b,"=",w(c)]));return b}function t(a){if(!a)return";";if(a.length==0)return"{}";return"{"+d+g(function(){return r(a).join(d)})+d+f("}")}function s(a){var c=a.length;if(c==0)return"{}";return"{"+d+MAP(a,function(a,e){var i=a[1].length>0,j=g(function(){return f(a[0]?h(["case",w(a[0])+":"]):"default:")},.5)+(i?d+g(function(){return r(a[1]).join(d)}):"");!b&&i&&e<c-1&&(j+=";");return j}).join(d)+d+f("}")}function r(a){for(var c=[],d=a.length-1,e=0;e<=d;++e){var g=a[e],h=w(g);h!=";"&&(!b&&e==d&&(g[0]=="while"&&empty(g[2])||member(g[0],["for","for-in"])&&empty(g[4])||g[0]=="if"&&empty(g[2])&&!g[3]||g[0]=="if"&&g[3]&&empty(g[3])?h=h.replace(/;*\s*$/,";"):h=h.replace(/;+\s*$/,"")),c.push(h))}return MAP(c,f)}function q(a){return a.toString()}function p(a,b,c,d){var e=d||"function";a&&(e+=" "+q(a)),e+="("+i(MAP(b,q))+")";return h([e,t(c)])}function o(a){if(a[0]=="do")return w(["block",[a]]);var b=a;while(!0){var c=b[0];if(c=="if"){if(!b[3])return w(["block",[a]]);b=b[3]}else if(c=="while"||c=="do")b=b[2];else if(c=="for"||c=="for-in")b=b[4];else break}return w(a)}function m(a){var b=a.toString(10),c=[b.replace(/^0\./,".")],d;Math.floor(a)===a?(c.push("0x"+a.toString(16).toLowerCase(),"0"+a.toString(8)),(d=/^(.*?)(0+)$/.exec(a))&&c.push(d[1]+"e"+d[2].length)):(d=/^0?\.(0+)(.*)$/.exec(a))&&c.push(d[2]+"e-"+(d[1].length+d[2].length),b.substr(b.indexOf(".")));return k(c)}function l(a){if(a[0]=="function"){var b=slice(v),c=b.pop(),d=b.pop();while(d){if(d[0]=="stat")return!0;if(d[0]=="seq"&&d[1]===c||d[0]=="call"&&d[1]===c||d[0]=="binary"&&d[2]===c)c=d,d=b.pop();else return!1}}return!HOP(DOT_CALL_NO_PARENS,a[0])}function k(a){if(a.length==1)return a[0];if(a.length==2){var b=a[1];a=a[0];return a.length<=b.length?a:b}return k([a[0],k(a.slice(1))])}function j(a){var b=w(a);for(var c=1;c<arguments.length;++c){var d=arguments[c];if(d instanceof Function&&d(a)||a[0]==d)return"("+b+")"}return b}function i(a){return a.join(","+e)}function h(a){if(b)return a.join(" ");var c=[];for(var d=0;d<a.length;++d){var e=a[d+1];c.push(a[d]),e&&(/[a-z0-9_\x24]$/i.test(a[d].toString())&&/^[a-z0-9_\x24]/i.test(e.toString())||/[\+\-]$/.test(a[d].toString())&&/^[\+\-]/.test(e.toString()))&&c.push(" ")}return c.join("")}function g(a,b){b==null&&(b=1),c+=b;try{return a.apply(null,slice(arguments,1))}finally{c-=b}}function f(a){a==null&&(a=""),b&&(a=repeat_string(" ",b.indent_start+c*b.indent_level)+a);return a}b&&(b=defaults(b,{indent_start:0,indent_level:4,quote_keys:!1,space_colon:!1}));var c=0,d=b?"\n":"",e=b?" ":"",n={string:make_string,num:m,name:q,toplevel:function(a){return r(a).join(d+d)},block:t,"var":function(a){return"var "+i(MAP(a,u))+";"},"const":function(a){return"const "+i(MAP(a,u))+";"},"try":function(a,b,c){var d=["try",t(a)];b&&d.push("catch","("+b[0]+")",t(b[1])),c&&d.push("finally",t(c));return h(d)},"throw":function(a){return h(["throw",w(a)])+";"},"new":function(a,b){b=b.length>0?"("+i(MAP(b,w))+")":"";return h(["new",j(a,"seq","binary","conditional","assign",function(a){var b=ast_walker(),c={};try{b.with_walkers({call:function(){throw c},"function":function(){return this}},function(){b.walk(a)})}catch(d){if(d===c)return!0;throw d}})+b])},"switch":function(a,b){return h(["switch","("+w(a)+")",s(b)])},"break":function(a){var b="break";a!=null&&(b+=" "+q(a));return b+";"},"continue":function(a){var b="continue";a!=null&&(b+=" "+q(a));return b+";"},conditional:function(a,b,c){return h([j(a,"assign","seq","conditional"),"?",j(b,"seq"),":",j(c,"seq")])},assign:function(a,b,c){a&&a!==!0?a+="=":a="=";return h([w(b),a,j(c,"seq")])},dot:function(a){var b=w(a),c=1;a[0]=="num"?b+=".":l(a)&&(b="("+b+")");while(c<arguments.length)b+="."+q(arguments[c++]);return b},call:function(a,b){var c=w(a);l(a)&&(c="("+c+")");return c+"("+i(MAP(b,function(a){return j(a,"seq")}))+")"},"function":p,defun:p,"if":function(a,b,c){var d=["if","("+w(a)+")",c?o(b):w(b)];c&&d.push("else",w(c));return h(d)},"for":function(a,b,c,d){var f=["for"];a=(a!=null?w(a):"").replace(/;*\s*$/,";"+e),b=(b!=null?w(b):"").replace(/;*\s*$/,";"+e),c=(c!=null?w(c):"").replace(/;*\s*$/,"");var g=a+b+c;g=="; ; "&&(g=";;"),f.push("("+g+")",w(d));return h(f)},"for-in":function(a,b,c,d){var e=h(["for","("]);a&&(e+="var "),e+=h([q(b)+" in "+w(c)+")",w(d)]);return e},"while":function(a,b){return h(["while","("+w(a)+")",w(b)])},"do":function(a,b){return h(["do",w(b),"while","("+w(a)+")"])+";"},"return":function(a){var b=["return"];a!=null&&b.push(w(a));return h(b)+";"},binary:function(a,b,c){var d=w(b),e=w(c);if(member(b[0],["assign","conditional","seq"])||b[0]=="binary"&&PRECEDENCE[a]>PRECEDENCE[b[1]])d="("+d+")";if(member(c[0],["assign","conditional","seq"])||c[0]=="binary"&&PRECEDENCE[a]>=PRECEDENCE[c[1]]&&(c[1]!=a||!member(a,["&&","||","*"])))e="("+e+")";return h([d,a,e])},"unary-prefix":function(a,b){var c=w(b);b[0]=="num"||b[0]=="unary-prefix"&&!HOP(OPERATORS,a+b[1])||!l(b)||(c="("+c+")");return a+(jsp.is_alphanumeric_char(a.charAt(0))?" ":"")+c},"unary-postfix":function(a,b){var c=w(b);b[0]=="num"||b[0]=="unary-postfix"&&!HOP(OPERATORS,a+b[1])||!l(b)||(c="("+c+")");return c+a},sub:function(a,b){var c=w(a);l(a)&&(c="("+c+")");return c+"["+w(b)+"]"},object:function(a){if(a.length==0)return"{}";return"{"+d+g(function(){return MAP(a,function(a){if(a.length==3)return f(p(a[0],a[1][2],a[1][3],a[2]));var c=a[0],d=w(a[1]);b&&b.quote_keys?c=make_string(c):(typeof c=="number"||!b&&+c+""==c)&&parseFloat(c)>=0?c=m(+c):is_identifier(c)||(c=make_string(c));return f(h(b&&b.space_colon?[c,":",d]:[c+":",d]))}).join(","+d)})+d+f("}")},regexp:function(a,b){return"/"+a+"/"+b},array:function(a){if(a.length==0)return"[]";return h(["[",i(MAP(a,function(a){if(!b&&a[0]=="atom"&&a[1]=="undefined")return"";return j(a,"seq")})),"]"])},stat:function(a){return w(a).replace(/;*\s*$/,";")},seq:function(){return i(MAP(slice(arguments),w))},label:function(a,b){return h([q(a),":",w(b)])},"with":function(a,b){return h(["with","("+w(a)+")",w(b)])},atom:function(a){return q(a)}},v=[];return w(a)}function make_string(a){var b=0,c=0;a=a.replace(/[\\\b\f\n\r\t\x22\x27]/g,function(a){switch(a){case"\\":return"\\\\";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case'"':++b;return'"';case"'":++c;return"'"}return a});return b>c?"'"+a.replace(/\x27/g,"\\'")+"'":'"'+a.replace(/\x22/g,'\\"')+'"'}function ast_squeeze(a,b){function l(a,b,c){a=d(a),b=d(b),c=d(c),empty(b)?(a=f(a),b=c,c=null):empty(c)?c=null:function(){var d=gen_code(a),e=f(a),g=gen_code(e);if(g.length<d.length){var h=b;b=c,c=h,a=e}}();if(empty(c)&&empty(b))return["stat",a];var e=["if",a,b,c];b[0]=="if"&&empty(b[3])&&empty(c)?e=best_of(e,d(["if",["binary","&&",a,b[1]],b[2]])):b[0]=="stat"?c?c[0]=="stat"&&(e=best_of(e,["stat",make_conditional(a,b[1],c[1])])):e=best_of(e,["stat",make_conditional(a,b[1])]):!c||b[0]!=c[0]||b[0]!="return"&&b[0]!="throw"?c&&aborts(b)?(e=[["if",a,b]],c[0]=="block"?c[1]&&(e=e.concat(c[1])):e.push(c),e=d(["block",e])):b&&aborts(c)&&(e=[["if",f(a),c]],b[0]=="block"?b[1]&&(e=e.concat(b[1])):e.push(b),e=d(["block",e])):e=best_of(e,[b[0],make_conditional(a,b[1],c[1])]);return e}function k(a,c){a=a.reduce(function(a,b){b[0]=="block"?b[1]&&a.push.apply(a,b[1]):a.push(b);return a},[]),a=function(b,c){a.forEach(function(a){c&&(a[0]=="var"&&c[0]=="var"||a[0]=="const"&&c[0]=="const")?c[1]=c[1].concat(a[1]):(b.push(a),c=a)});return b}([]),b.dead_code&&(a=function(c,d){a.forEach(function(a){d?member(a[0],["function","defun","var","const"])?c.push(a):b.no_warnings||warn("Removing unreachable code: "+gen_code(a,!0)):(c.push(a),member(a[0],["return","throw","break","continue"])&&(d=!0))});return c}([])),b.make_seqs&&(a=function(b,c){a.forEach(function(a){c&&c[0]=="stat"&&a[0]=="stat"?c[1]=["seq",c[1],a[1]]:(b.push(a),c=a)});return b}([])),c=="lambda"&&(a=function(b,c,d){while(b<a.length){d=a[b++];if(d[0]=="if"&&!d[3]){if(d[2][0]=="return"&&d[2][1]==null){c.push(l(f(d[1]),["block",a.slice(b)]));break}var e=last_stat(d[2]);if(e[0]=="return"&&e[1]==null){c.push(l(d[1],["block",d[2][1].slice(0,-1)],["block",a.slice(b)]));break}}c.push(d)}return c}(0,[]));return a}function j(a,b,c){return[this[0],a,b,g(c.scope,function(){return k(MAP(c,d),"lambda")})]}function i(a){a!=null&&a[0]=="block"&&a[1]&&a[1].length==1&&(a=a[1][0]);return a}function h(a){return a[0]=="string"||a[0]=="num"}function g(a,b){var c=e;e=a;var d=b();d.scope=a,e=c;return d}function f(a){var c=["unary-prefix","!",a];switch(a[0]){case"unary-prefix":return a[1]=="!"&&boolean_expr(a[2])?a[2]:c;case"seq":a=slice(a),a[a.length-1]=f(a[a.length-1]);return a;case"conditional":return best_of(c,["conditional",a[1],f(a[2]),f(a[3])]);case"binary":var d=a[1],e=a[2],g=a[3];if(!b.keep_comps)switch(d){case"<=":return["binary",">",e,g];case"<":return["binary",">=",e,g];case">=":return["binary","<",e,g];case">":return["binary","<=",e,g]}switch(d){case"==":return["binary","!=",e,g];case"!=":return["binary","==",e,g];case"===":return["binary","!==",e,g];case"!==":return["binary","===",e,g];case"&&":return best_of(c,["binary","||",f(e),f(g)]);case"||":return best_of(c,["binary","&&",f(e),f(g)])}}return c}b=defaults(b,{make_seqs:!0,dead_code:!0,keep_comps:!0,no_warnings:!1});var c=ast_walker(),d=c.walk,e;return c.with_walkers({sub:function(a,b){if(b[0]=="string"){var c=b[1];if(is_identifier(c))return["dot",d(a),c]}},"if":l,toplevel:function(a){return["toplevel",g(this.scope,function(){return k(MAP(a,d))})]},"switch":function(a,b){var c=b.length-1;return["switch",d(a),MAP(b,function(a,b){var e=k(MAP(a[1],d));if(b==c&&e.length>0){var f=e[e.length-1];f[0]=="break"&&!f[1]&&e.pop()}return[a[0]?d(a[0]):null,e]})]},"function":j,defun:j,block:function(a){if(a)return i(["block",k(MAP(a,d))])},binary:function(a,b,c){b=d(b),c=d(c);var e=["binary",a,b,c];if(h(c)&&h(b)){var f={},g=f;switch(a){case"+":f=b[1]+c[1];break;case"*":f=b[1]*c[1];break;case"/":f=b[1]/c[1];break;case"-":f=b[1]-c[1];break;case"<<":f=b[1]<<c[1];break;case">>":f=b[1]>>c[1];break;case">>>":f=b[1]>>>c[1];break;case"==":f=b[1]==c[1];break;case"===":f=b[1]===c[1];break;case"!=":f=b[1]!=c[1];break;case"!==":f=b[1]!==c[1];break;case"<":f=b[1]<c[1];break;case"<=":f=b[1]<=c[1];break;case">":f=b[1]>c[1];break;case">=":f=b[1]>=c[1]}if(f!==g){switch(typeof f){case"string":f=["string",f];break;case"boolean":f=["name",f+""];break;case"number":f=["num",f];break;default:return e}e=best_of(e,d(f))}}return e},conditional:function(a,b,c){return make_conditional(d(a),d(b),d(c))},"try":function(a,b,c){return["try",k(MAP(a,d)),b!=null?[b[0],k(MAP(b[1],d))]:null,c!=null?k(MAP(c,d)):null]},"unary-prefix":function(a,b){b=d(b);var c=["unary-prefix",a,b];a=="!"&&(c=best_of(c,f(b)));return c},name:function(a){switch(a){case"true":return["unary-prefix","!",["num",0]];case"false":return["unary-prefix","!",["num",1]]}},"new":function(a,b){if(a[0]=="name"&&a[1]=="Array"&&!e.has("Array"))return b.length!=1?["array",b]:["call",["name","Array"],b]},call:function(a,b){if(a[0]=="name"&&a[1]=="Array"&&b.length!=1&&!e.has("Array"))return["array",b]}},function(){return d(ast_add_scope(a))})}function empty(a){return!a||a[0]=="block"&&(!a[1]||a[1].length==0)}function make_conditional(a,b,c){return a[0]=="unary-prefix"&&a[1]=="!"?c?["conditional",a[2],c,b]:["binary","||",a[2],b]:c?["conditional",a,b,c]:["binary","&&",a,b]}function boolean_expr(a){return a[0]=="unary-prefix"&&member(a[1],["!","delete"])||a[0]=="binary"&&member(a[1],["in","instanceof","==","!=","===","!==","<","<=",">=",">"])||a[0]=="binary"&&member(a[1],["&&","||"])&&boolean_expr(a[2])&&boolean_expr(a[3])||a[0]=="conditional"&&boolean_expr(a[2])&&boolean_expr(a[3])||a[0]=="assign"&&a[1]===!0&&boolean_expr(a[3])||a[0]=="seq"&&boolean_expr(a[a.length-1])}function aborts(a){if(a){a=last_stat(a);if(a[0]=="return"||a[0]=="break"||a[0]=="continue"||a[0]=="throw")return!0}}function last_stat(a){if(a[0]=="block"&&a[1]&&a[1].length>0)return a[1][a[1].length-1];return a}function best_of(a,b){return gen_code(a).length>gen_code(b[0]=="stat"?b[1]:b).length?b:a}function ast_mangle(a,b){function i(a){return[this[0],MAP(a,function(a){return[f(a[0]),d(a[1])]})]}function h(a,b){var c=e;e=a;for(var d in a.names)HOP(a.names,d)&&f(d,!0);var g=b();g.scope=a,e=c;return g}function g(a,b,c){a&&(a=f(a)),c=h(c.scope,function(){b=MAP(b,function(a){return f(a)});return MAP(c,d)});return[this[0],a,b,c]}function f(a,c){if(!b&&!e.parent)return a;return e.get_mangled(a,c)}var c=ast_walker(),d=c.walk,e;return c.with_walkers({"function":g,defun:function(){var a=g.apply(this,arguments);switch(c.parent()[0]){case"toplevel":case"function":case"defun":return MAP.at_top(a)}return a},"var":i,"const":i,name:function(a){return[this[0],f(a)]},"try":function(a,b,c){return[this[0],MAP(a,d),b!=null?[f(b[0]),MAP(b[1],d)]:null,c!=null?MAP(c,d):null]},toplevel:function(a){var b=this;return h(b.scope,function(){return[b[0],MAP(a,d)]})},"for-in":function(a,b,c,e){return[this[0],a,f(b),d(c),d(e)]}},function(){return d(ast_add_scope(a))})}function ast_add_scope(a){function i(a,b,c){return[this[0],g(a),b,f(function(){MAP(b,g);return MAP(c,d)})]}function h(a){b.refs[a]=!0}function g(a){return b.define(a)}function f(a){b=new Scope(b);var c=b.body=a();c.scope=b,b=b.parent;return c}var b=null,c=ast_walker(),d=c.walk,e=[];return f(function(){function j(a,b){for(b=a.children.length;--b>=0;)j(a.children[b]);for(b in a.refs)if(HOP(a.refs,b))for(var c=a.has(b),d=a;d;d=d.parent){d.refs[b]=c;if(d===c)break}}var f=c.with_walkers({"function":i,defun:i,"with":function(a,c){for(var d=b;d;d=d.parent)d.uses_with=!0},"var":function(a){MAP(a,function(a){g(a[0])})},"const":function(a){MAP(a,function(a){g(a[0])})},"try":function(a,b,c){if(b!=null)return[this[0],MAP(a,d),[g(b[0]),MAP(b[1],d)],c!=null?MAP(c,d):null]},name:function(a){a=="eval"&&e.push(b),h(a)},"for-in":function(a,b){a?g(b):h(b)}},function(){return d(a)});MAP(e,function(a){if(!a.has("eval"))while(a)a.uses_eval=!0,a=a.parent}),j(b);return f})}function Scope(a){this.names={},this.mangled={},this.rev_mangled={},this.cname=-1,this.refs={},this.uses_with=!1,this.uses_eval=!1,this.parent=a,this.children=[],a?(this.level=a.level+1,a.children.push(this)):this.level=0}function ast_walker(a){function g(a,b){var c={},e;for(e in a)HOP(a,e)&&(c[e]=d[e],d[e]=a[e]);var f=b();for(e in c)HOP(c,e)&&(c[e]?d[e]=c[e]:delete d[e]);return f}function f(a){if(a==null)return null;try{e.push(a);var b=a[0],f=d[b];if(f){var g=f.apply(a,a.slice(1));if(g!=null)return g}f=c[b];return f.apply(a,a.slice(1))}finally{e.pop()}}function b(a){return[this[0],MAP(a,function(a){var b=[a[0]];a.length>1&&(b[1]=f(a[1]));return b})]}var c={string:function(a){return[this[0],a]},num:function(a){return[this[0],a]},name:function(a){return[this[0],a]},toplevel:function(a){return[this[0],MAP(a,f)]},block:function(a){var b=[this[0]];a!=null&&b.push(MAP(a,f));return b},"var":b,"const":b,"try":function(a,b,c){return[this[0],MAP(a,f),b!=null?[b[0],MAP(b[1],f)]:null,c!=null?MAP(c,f):null]},"throw":function(a){return[this[0],f(a)]},"new":function(a,b){return[this[0],f(a),MAP(b,f)]},"switch":function(a,b){return[this[0],f(a),MAP(b,function(a){return[a[0]?f(a[0]):null,MAP(a[1],f)]})]},"break":function(a){return[this[0],a]},"continue":function(a){return[this[0],a]},conditional:function(a,b,c){return[this[0],f(a),f(b),f(c)]},assign:function(a,b,c){return[this[0],a,f(b),f(c)]},dot:function(a){return[this[0],f(a)].concat(slice(arguments,1))},call:function(a,b){return[this[0],f(a),MAP(b,f)]},"function":function(a,b,c){return[this[0],a,b.slice(),MAP(c,f)]},defun:function(a,b,c){return[this[0],a,b.slice(),MAP(c,f)]},"if":function(a,b,c){return[this[0],f(a),f(b),f(c)]},"for":function(a,b,c,d){return[this[0],f(a),f(b),f(c),f(d)]},"for-in":function(a,b,c,d){return[this[0],a,b,f(c),f(d)]},"while":function(a,b){return[this[0],f(a),f(b)]},"do":function(a,b){return[this[0],f(a),f(b)]},"return":function(a){return[this[0],f(a)]},binary:function(a,b,c){return[this[0],a,f(b),f(c)]},"unary-prefix":function(a,b){return[this[0],a,f(b)]},"unary-postfix":function(a,b){return[this[0],a,f(b)]},sub:function(a,b){return[this[0],f(a),f(b)]},object:function(a){return[this[0],MAP(a,function(a){return a.length==2?[a[0],f(a[1])]:[a[0],f(a[1]),a[2]]})]},regexp:function(a,b){return[this[0],a,b]},array:function(a){return[this[0],MAP(a,f)]},stat:function(a){return[this[0],f(a)]},seq:function(){return[this[0]].concat(MAP(slice(arguments),f))},label:function(a,b){return[this[0],a,f(b)]},"with":function(a,b){return[this[0],f(a),f(b)]},atom:function(a){return[this[0],a]}},d={},e=[];return{walk:f,with_walkers:g,parent:function(){return e[e.length-2]},stack:function(){return e}}}var jsp=require("./parse-js"),slice=jsp.slice,member=jsp.member,PRECEDENCE=jsp.PRECEDENCE,OPERATORS=jsp.OPERATORS,base54=function(){var a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_";return function(b){var c="";do c=a.charAt(b%54)+c,b=Math.floor(b/54);while(b>0);return c}}();Scope.prototype={has:function(a){for(var b=this;b;b=b.parent)if(HOP(b.names,a))return b},has_mangled:function(a){for(var b=this;b;b=b.parent)if(HOP(b.rev_mangled,a))return b},toJSON:function(){return{names:this.names,uses_eval:this.uses_eval,uses_with:this.uses_with}},next_mangled:function(){for(;;){var a=base54(++this.cname),b;b=this.has_mangled(a);if(b&&this.refs[b.rev_mangled[a]]===b)continue;b=this.has(a);if(b&&b!==this&&this.refs[a]===b&&!b.has_mangled(a))continue;if(HOP(this.refs,a)&&this.refs[a]==null)continue;if(!is_identifier(a))continue;return a}},get_mangled:function(a,b){if(this.uses_eval||this.uses_with)return a;var c=this.has(a);if(!c)return a;if(HOP(c.mangled,a))return c.mangled[a];if(!b)return a;var d=c.next_mangled();c.rev_mangled[d]=a;return c.mangled[a]=d},define:function(a){if(a!=null)return this.names[a]=a}};var warn=function(){},DOT_CALL_NO_PARENS=jsp.array_to_hash(["name","array","string","dot","sub","call","regexp"]),MAP;(function(){function a(a){this.v=a}MAP=function(b,c,d){var e=[];for(var f=0;f<b.length;++f){var g=c.call(d,b[f],f);g instanceof a?e.unshift(g.v):e.push(g)}return e},MAP.at_top=function(b){return new a(b)}})(),exports.ast_walker=ast_walker,exports.ast_mangle=ast_mangle,exports.ast_squeeze=ast_squeeze,exports.gen_code=gen_code,exports.ast_add_scope=ast_add_scope,exports.ast_squeeze_more=require("./squeeze-more").ast_squeeze_more,exports.set_logger=function(a){warn=a},exports.make_string=make_string,exports.split_lines=split_lines