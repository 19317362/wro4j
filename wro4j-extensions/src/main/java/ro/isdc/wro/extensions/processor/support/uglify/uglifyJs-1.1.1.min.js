var KEYWORDS=array_to_hash(["break","case","catch","const","continue","default","delete","do","else","finally","for","function","if","in","instanceof","new","return","switch","throw","try","typeof","var","void","while","with"]);var RESERVED_WORDS=array_to_hash(["abstract","boolean","byte","char","class","debugger","double","enum","export","extends","final","float","goto","implements","import","int","interface","long","native","package","private","protected","public","short","static","super","synchronized","throws","transient","volatile"]);var KEYWORDS_BEFORE_EXPRESSION=array_to_hash(["return","new","delete","throw","else","case"]);var KEYWORDS_ATOM=array_to_hash(["false","null","true","undefined"]);var OPERATOR_CHARS=array_to_hash(characters("+-*&%=<>!?|~^"));var RE_HEX_NUMBER=/^0x[0-9a-f]+$/i;var RE_OCT_NUMBER=/^0[0-7]+$/;var RE_DEC_NUMBER=/^\d*\.?\d*(?:e[+-]?\d*(?:\d\.?|\.?\d)\d*)?$/i;var OPERATORS=array_to_hash(["in","instanceof","typeof","new","void","delete","++","--","+","-","!","~","&","|","^","*","/","%",">>","<<",">>>","<",">","<=",">=","==","===","!=","!==","?","=","+=","-=","/=","*=","%=",">>=","<<=",">>>=","|=","^=","&=","&&","||"]);var WHITESPACE_CHARS=array_to_hash(characters(" \u00a0\n\r\t\f\u000b\u200b\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000"));var PUNC_BEFORE_EXPRESSION=array_to_hash(characters("[{}(,.;:"));var PUNC_CHARS=array_to_hash(characters("[]{}(),;:"));var REGEXP_MODIFIERS=array_to_hash(characters("gmsiy"));var UNICODE={letter:new RegExp("[\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0523\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0621-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971\\u0972\\u097B-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D28\\u0D2A-\\u0D39\\u0D3D\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC\\u0EDD\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8B\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10D0-\\u10FA\\u10FC\\u1100-\\u1159\\u115F-\\u11A2\\u11A8-\\u11F9\\u1200-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u1676\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19A9\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u2094\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2C6F\\u2C71-\\u2C7D\\u2C80-\\u2CE4\\u2D00-\\u2D25\\u2D30-\\u2D65\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31B7\\u31F0-\\u31FF\\u3400\\u4DB5\\u4E00\\u9FC3\\uA000-\\uA48C\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA65F\\uA662-\\uA66E\\uA67F-\\uA697\\uA717-\\uA71F\\uA722-\\uA788\\uA78B\\uA78C\\uA7FB-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA90A-\\uA925\\uA930-\\uA946\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAC00\\uD7A3\\uF900-\\uFA2D\\uFA30-\\uFA6A\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),non_spacing_mark:new RegExp("[\\u0300-\\u036F\\u0483-\\u0487\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065E\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0711\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F3\\u0816-\\u0819\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0900-\\u0902\\u093C\\u0941-\\u0948\\u094D\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09BC\\u09C1-\\u09C4\\u09CD\\u09E2\\u09E3\\u0A01\\u0A02\\u0A3C\\u0A41\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A70\\u0A71\\u0A75\\u0A81\\u0A82\\u0ABC\\u0AC1-\\u0AC5\\u0AC7\\u0AC8\\u0ACD\\u0AE2\\u0AE3\\u0B01\\u0B3C\\u0B3F\\u0B41-\\u0B44\\u0B4D\\u0B56\\u0B62\\u0B63\\u0B82\\u0BC0\\u0BCD\\u0C3E-\\u0C40\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62\\u0C63\\u0CBC\\u0CBF\\u0CC6\\u0CCC\\u0CCD\\u0CE2\\u0CE3\\u0D41-\\u0D44\\u0D4D\\u0D62\\u0D63\\u0DCA\\u0DD2-\\u0DD4\\u0DD6\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E\\u0EB1\\u0EB4-\\u0EB9\\u0EBB\\u0EBC\\u0EC8-\\u0ECD\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F71-\\u0F7E\\u0F80-\\u0F84\\u0F86\\u0F87\\u0F90-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u102D-\\u1030\\u1032-\\u1037\\u1039\\u103A\\u103D\\u103E\\u1058\\u1059\\u105E-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108D\\u109D\\u135F\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17B7-\\u17BD\\u17C6\\u17C9-\\u17D3\\u17DD\\u180B-\\u180D\\u18A9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193B\\u1A17\\u1A18\\u1A56\\u1A58-\\u1A5E\\u1A60\\u1A62\\u1A65-\\u1A6C\\u1A73-\\u1A7C\\u1A7F\\u1B00-\\u1B03\\u1B34\\u1B36-\\u1B3A\\u1B3C\\u1B42\\u1B6B-\\u1B73\\u1B80\\u1B81\\u1BA2-\\u1BA5\\u1BA8\\u1BA9\\u1C2C-\\u1C33\\u1C36\\u1C37\\u1CD0-\\u1CD2\\u1CD4-\\u1CE0\\u1CE2-\\u1CE8\\u1CED\\u1DC0-\\u1DE6\\u1DFD-\\u1DFF\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2CEF-\\u2CF1\\u2DE0-\\u2DFF\\u302A-\\u302F\\u3099\\u309A\\uA66F\\uA67C\\uA67D\\uA6F0\\uA6F1\\uA802\\uA806\\uA80B\\uA825\\uA826\\uA8C4\\uA8E0-\\uA8F1\\uA926-\\uA92D\\uA947-\\uA951\\uA980-\\uA982\\uA9B3\\uA9B6-\\uA9B9\\uA9BC\\uAA29-\\uAA2E\\uAA31\\uAA32\\uAA35\\uAA36\\uAA43\\uAA4C\\uAAB0\\uAAB2-\\uAAB4\\uAAB7\\uAAB8\\uAABE\\uAABF\\uAAC1\\uABE5\\uABE8\\uABED\\uFB1E\\uFE00-\\uFE0F\\uFE20-\\uFE26]"),space_combining_mark:new RegExp("[\\u0903\\u093E-\\u0940\\u0949-\\u094C\\u094E\\u0982\\u0983\\u09BE-\\u09C0\\u09C7\\u09C8\\u09CB\\u09CC\\u09D7\\u0A03\\u0A3E-\\u0A40\\u0A83\\u0ABE-\\u0AC0\\u0AC9\\u0ACB\\u0ACC\\u0B02\\u0B03\\u0B3E\\u0B40\\u0B47\\u0B48\\u0B4B\\u0B4C\\u0B57\\u0BBE\\u0BBF\\u0BC1\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCC\\u0BD7\\u0C01-\\u0C03\\u0C41-\\u0C44\\u0C82\\u0C83\\u0CBE\\u0CC0-\\u0CC4\\u0CC7\\u0CC8\\u0CCA\\u0CCB\\u0CD5\\u0CD6\\u0D02\\u0D03\\u0D3E-\\u0D40\\u0D46-\\u0D48\\u0D4A-\\u0D4C\\u0D57\\u0D82\\u0D83\\u0DCF-\\u0DD1\\u0DD8-\\u0DDF\\u0DF2\\u0DF3\\u0F3E\\u0F3F\\u0F7F\\u102B\\u102C\\u1031\\u1038\\u103B\\u103C\\u1056\\u1057\\u1062-\\u1064\\u1067-\\u106D\\u1083\\u1084\\u1087-\\u108C\\u108F\\u109A-\\u109C\\u17B6\\u17BE-\\u17C5\\u17C7\\u17C8\\u1923-\\u1926\\u1929-\\u192B\\u1930\\u1931\\u1933-\\u1938\\u19B0-\\u19C0\\u19C8\\u19C9\\u1A19-\\u1A1B\\u1A55\\u1A57\\u1A61\\u1A63\\u1A64\\u1A6D-\\u1A72\\u1B04\\u1B35\\u1B3B\\u1B3D-\\u1B41\\u1B43\\u1B44\\u1B82\\u1BA1\\u1BA6\\u1BA7\\u1BAA\\u1C24-\\u1C2B\\u1C34\\u1C35\\u1CE1\\u1CF2\\uA823\\uA824\\uA827\\uA880\\uA881\\uA8B4-\\uA8C3\\uA952\\uA953\\uA983\\uA9B4\\uA9B5\\uA9BA\\uA9BB\\uA9BD-\\uA9C0\\uAA2F\\uAA30\\uAA33\\uAA34\\uAA4D\\uAA7B\\uABE3\\uABE4\\uABE6\\uABE7\\uABE9\\uABEA\\uABEC]"),connector_punctuation:new RegExp("[\\u005F\\u203F\\u2040\\u2054\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFF3F]")};function is_letter(a){return UNICODE.letter.test(a);}function is_digit(a){a=a.charCodeAt(0);return a>=48&&a<=57;}function is_alphanumeric_char(a){return is_digit(a)||is_letter(a);}function is_unicode_combining_mark(a){return UNICODE.non_spacing_mark.test(a)||UNICODE.space_combining_mark.test(a);}function is_unicode_connector_punctuation(a){return UNICODE.connector_punctuation.test(a);}function is_identifier_start(a){return a=="$"||a=="_"||is_letter(a);}function is_identifier_char(a){return is_identifier_start(a)||is_unicode_combining_mark(a)||is_digit(a)||is_unicode_connector_punctuation(a)||a=="\u200c"||a=="\u200d";}function parse_js_number(a){if(RE_HEX_NUMBER.test(a)){return parseInt(a.substr(2),16);}else{if(RE_OCT_NUMBER.test(a)){return parseInt(a.substr(1),8);}else{if(RE_DEC_NUMBER.test(a)){return parseFloat(a);}}}}function JS_Parse_Error(c,a,b,d){this.message=c;this.line=a;this.col=b;this.pos=d;this.stack=new Error().stack;}JS_Parse_Error.prototype.toString=function(){return this.message+" (line: "+this.line+", col: "+this.col+", pos: "+this.pos+")\n\n"+this.stack;};function js_error(c,a,b,d){throw new JS_Parse_Error(c,a,b,d);}function is_token(a,b,c){return a.type==b&&(c==null||a.value==c);}var EX_EOF={};function tokenizer(b){var f={text:b.replace(/\r\n?|[\n\u2028\u2029]/g,"\n").replace(/^\uFEFF/,""),pos:0,tokpos:0,line:0,tokline:0,col:0,tokcol:0,newline_before:false,regex_allowed:false,comments_before:[]};function t(){return f.text.charAt(f.pos);}function s(z,A){var B=f.text.charAt(f.pos++);if(z&&!B){throw EX_EOF;}if(B=="\n"){f.newline_before=f.newline_before||!A;++f.line;f.col=0;}else{++f.col;}return B;}function o(){return !f.peek();}function q(A,z){var B=f.text.indexOf(A,f.pos);if(z&&B==-1){throw EX_EOF;}return B;}function p(){f.tokline=f.line;f.tokcol=f.col;f.tokpos=f.pos;}function j(B,C,A){f.regex_allowed=((B=="operator"&&!HOP(UNARY_POSTFIX,C))||(B=="keyword"&&HOP(KEYWORDS_BEFORE_EXPRESSION,C))||(B=="punc"&&HOP(PUNC_BEFORE_EXPRESSION,C)));var z={type:B,value:C,line:f.tokline,col:f.tokcol,pos:f.tokpos,nlb:f.newline_before};if(!A){z.comments_before=f.comments_before;f.comments_before=[];}f.newline_before=false;return z;}function y(){while(HOP(WHITESPACE_CHARS,t())){s();}}function l(z){var A="",C=t(),B=0;while(C&&z(C,B++)){A+=s();C=t();}return A;}function u(z){js_error(z,f.tokline,f.tokcol,f.tokpos);}function n(E){var C=false,A=false,F=false,z=E==".";var B=l(function(H,G){if(H=="x"||H=="X"){if(F){return false;}return F=true;}if(!F&&(H=="E"||H=="e")){if(C){return false;}return C=A=true;}if(H=="-"){if(A||(G==0&&!E)){return true;}return false;}if(H=="+"){return A;}A=false;if(H=="."){if(!z&&!F){return z=true;}return false;}return is_alphanumeric_char(H);});if(E){B=E+B;}var D=parse_js_number(B);if(!isNaN(D)){return j("num",D);}else{u("Invalid syntax: "+B);}}function r(z){var A=s(true,z);switch(A){case"n":return"\n";case"r":return"\r";case"t":return"\t";case"b":return"\b";case"v":return"\u000b";case"f":return"\f";case"0":return"\0";case"x":return String.fromCharCode(k(2));case"u":return String.fromCharCode(k(4));case"\n":return"";default:return A;}}function k(B){var z=0;for(;B>0;--B){var A=parseInt(s(true),16);if(isNaN(A)){u("Invalid hex-character pattern in string");}z=(z<<4)|A;}return z;}function e(){return g("Unterminated string constant",function(){var z=s(),A="";for(;;){var B=s(true);if(B=="\\"){var D=0,C=null;B=l(function(E){if(E>="0"&&E<="7"){if(!C){C=E;return ++D;}else{if(C<="3"&&D<=2){return ++D;}else{if(C>="4"&&D<=1){return ++D;}}}}return false;});if(D>0){B=String.fromCharCode(parseInt(B,8));}else{B=r(true);}}else{if(B==z){break;}}A+=B;}return j("string",A);});}function v(){s();var A=q("\n"),z;if(A==-1){z=f.text.substr(f.pos);f.pos=f.text.length;}else{z=f.text.substring(f.pos,A);f.pos=A;}return j("comment1",z,true);}function x(){s();return g("Unterminated multiline comment",function(){var A=q("*/",true),B=f.text.substring(f.pos,A),z=j("comment2",B,true);f.pos=A+2;f.line+=B.split("\n").length-1;f.newline_before=B.indexOf("\n")>=0;if(/^@cc_on/i.test(B)){warn("WARNING: at line "+f.line);warn('*** Found "conditional comment": '+B);warn("*** UglifyJS DISCARDS ALL COMMENTS.  This means your code might no longer work properly in Internet Explorer.");}return z;});}function i(){var B=false,z="",A;while((A=t())!=null){if(!B){if(A=="\\"){B=true,s();}else{if(is_identifier_char(A)){z+=s();}else{break;}}}else{if(A!="u"){u("Expecting UnicodeEscapeSequence -- uXXXX");}A=r();if(!is_identifier_char(A)){u("Unicode char: "+A.charCodeAt(0)+" is not valid in identifier");}z+=A;B=false;}}return z;}function c(z){return g("Unterminated regular expression",function(){var A=false,B,D=false;while((B=s(true))){if(A){z+="\\"+B;A=false;}else{if(B=="["){D=true;z+=B;}else{if(B=="]"&&D){D=false;z+=B;}else{if(B=="/"&&!D){break;}else{if(B=="\\"){A=true;}else{z+=B;}}}}}}var C=i();return j("regexp",[z,C]);});}function w(z){function A(C){if(!t()){return C;}var B=C+t();if(HOP(OPERATORS,B)){s();return A(B);}else{return C;}}return j("operator",A(z||s()));}function h(){s();var z=f.regex_allowed;switch(t()){case"/":f.comments_before.push(v());f.regex_allowed=z;return m();case"*":f.comments_before.push(x());f.regex_allowed=z;return m();}return f.regex_allowed?c(""):w("/");}function a(){s();return is_digit(t())?n("."):j("punc",".");}function d(){var z=i();return !HOP(KEYWORDS,z)?j("name",z):HOP(OPERATORS,z)?j("operator",z):HOP(KEYWORDS_ATOM,z)?j("atom",z):j("keyword",z);}function g(B,z){try{return z();}catch(A){if(A===EX_EOF){u(B);}else{throw A;}}}function m(A){if(A!=null){return c(A);}y();p();var z=t();if(!z){return j("eof");}if(is_digit(z)){return n();}if(z=='"'||z=="'"){return e();}if(HOP(PUNC_CHARS,z)){return j("punc",s());}if(z=="."){return a();}if(z=="/"){return h();}if(HOP(OPERATOR_CHARS,z)){return w();}if(z=="\\"||is_identifier_start(z)){return d();}u("Unexpected character '"+z+"'");}m.context=function(z){if(z){f=z;}return f;};return m;}var UNARY_PREFIX=array_to_hash(["typeof","void","delete","--","++","!","~","-","+"]);var UNARY_POSTFIX=array_to_hash(["--","++"]);var ASSIGNMENT=(function(b,c,d){while(d<b.length){c[b[d]]=b[d].substr(0,b[d].length-1);d++;}return c;})(["+=","-=","/=","*=","%=",">>=","<<=",">>>=","|=","^=","&="],{"=":true},0);var PRECEDENCE=(function(d,f){for(var g=0,h=1;g<d.length;++g,++h){var c=d[g];for(var e=0;e<c.length;++e){f[c[e]]=h;}}return f;})([["||"],["&&"],["|"],["^"],["&"],["==","===","!=","!=="],["<",">","<=",">=","in","instanceof"],[">>","<<",">>>"],["+","-"],["*","/","%"]],{});var STATEMENTS_WITH_LABELS=array_to_hash(["for","do","while","switch"]);var ATOMIC_START_TOKEN=array_to_hash(["atom","num","string","regexp","name"]);function NodeWithToken(b,c,a){this.name=b;this.start=c;this.end=a;}NodeWithToken.prototype.toString=function(){return this.name;};function parse(e,M,g){var k={input:typeof e=="string"?tokenizer(e,true):e,token:null,prev:null,peeked:null,in_function:0,in_loop:0,labels:[]};k.token=i();function x(S,aa){return is_token(k.token,S,aa);}function n(){return k.peeked||(k.peeked=k.input());}function i(){k.prev=k.token;if(k.peeked){k.token=k.peeked;k.peeked=null;}else{k.token=k.input();}return k.token;}function A(){return k.prev;}function h(ac,aa,ab,ad){var S=k.input.context();js_error(ac,aa!=null?aa:S.tokline,ab!=null?ab:S.tokcol,ad!=null?ad:S.tokpos);}function c(S,aa){h(aa,S.line,S.col);}function K(S){if(S==null){S=k.token;}c(S,"Unexpected token: "+S.type+" ("+S.value+")");}function w(S,aa){if(x(S,aa)){return i();}c(k.token,"Unexpected token "+k.token.type+", expected "+S);}function d(S){return w("punc",S);}function C(){return !M&&(k.token.nlb||x("eof")||x("punc","}"));}function U(){if(x("punc",";")){i();}else{if(!C()){K();}}}function l(){return slice(arguments);}function m(){d("(");var S=u();d(")");return S;}function r(aa,ab,S){return aa instanceof NodeWithToken?aa:new NodeWithToken(aa,ab,S);}function L(S){if(g){return function(){var ab=k.token;var aa=S.apply(this,arguments);aa[0]=r(aa[0],ab,A());return aa;};}else{return S;}}var v=L(function(){if(x("operator","/")||x("operator","/=")){k.peeked=null;k.token=k.input(k.token.value.substr(1));}switch(k.token.type){case"num":case"string":case"regexp":case"operator":case"atom":return q();case"name":return is_token(n(),"punc",":")?R(prog1(k.token.value,i,i)):q();case"punc":switch(k.token.value){case"{":return l("block",p());case"[":case"(":return q();case";":i();return l("block");default:K();}case"keyword":switch(prog1(k.token.value,i)){case"break":return V("break");case"continue":return V("continue");case"debugger":U();return l("debugger");case"do":return(function(S){w("keyword","while");return l("do",prog1(m,U),S);})(j(v));case"for":return N();case"function":return B(true);case"if":return y();case"return":if(k.in_function==0){h("'return' outside of function");}return l("return",x("punc",";")?(i(),null):C()?null:prog1(u,U));case"switch":return l("switch",m(),s());case"throw":if(k.token.nlb){h("Illegal newline after 'throw'");}return l("throw",prog1(u,U));case"try":return Q();case"var":return prog1(a,U);case"const":return prog1(J,U);case"while":return l("while",m(),j(v));case"with":return l("with",m(),v());default:K();}}});function R(S){k.labels.push(S);var ab=k.token,aa=v();if(M&&!HOP(STATEMENTS_WITH_LABELS,aa[0])){K(ab);}k.labels.pop();return l("label",S,aa);}function q(){return l("stat",prog1(u,U));}function V(aa){var S;if(!C()){S=x("name")?k.token.value:null;}if(S!=null){i();if(!member(S,k.labels)){h("Label "+S+" without matching loop or statement");}}else{if(k.in_loop==0){h(aa+" not inside a loop or switch");}}U();return l(aa,S);}function N(){d("(");var S=null;if(!x("punc",";")){S=x("keyword","var")?(i(),a(true)):u(true,true);if(x("operator","in")){return E(S);}}return I(S);}function I(aa){d(";");var ab=x("punc",";")?null:u();d(";");var S=x("punc",")")?null:u();d(")");return l("for",aa,ab,S,j(v));}function E(ab){var S=ab[0]=="var"?l("name",ab[1][0]):ab;i();var aa=u();d(")");return l("for-in",ab,S,aa,j(v));}var B=L(function(S){var aa=x("name")?prog1(k.token.value,i):null;if(S&&!aa){K();}d("(");return l(S?"defun":"function",aa,(function(ac,ab){while(!x("punc",")")){if(ac){ac=false;}else{d(",");}if(!x("name")){K();}ab.push(k.token.value);i();}i();return ab;})(true,[]),(function(){++k.in_function;var ac=k.in_loop;k.in_loop=0;var ab=p();--k.in_function;k.in_loop=ac;return ab;})());});function y(){var ab=m(),S=v(),aa;if(x("keyword","else")){i();aa=v();}return l("if",ab,S,aa);}function p(){d("{");var S=[];while(!x("punc","}")){if(x("eof")){K();}S.push(v());}i();return S;}var s=curry(j,function(){d("{");var S=[],aa=null;while(!x("punc","}")){if(x("eof")){K();}if(x("keyword","case")){i();aa=[];S.push([u(),aa]);d(":");}else{if(x("keyword","default")){i();d(":");aa=[];S.push([null,aa]);}else{if(!aa){K();}aa.push(v());}}}i();return S;});function Q(){var S=p(),aa,ac;if(x("keyword","catch")){i();d("(");if(!x("name")){h("Name expected");}var ab=k.token.value;i();d(")");aa=[ab,p()];}if(x("keyword","finally")){i();ac=p();}if(!aa&&!ac){h("Missing catch/finally blocks");}return l("try",S,aa,ac);}function b(aa){var S=[];for(;;){if(!x("name")){K();}var ab=k.token.value;i();if(x("operator","=")){i();S.push([ab,u(false,aa)]);}else{S.push([ab]);}if(!x("punc",",")){break;}i();}return S;}function a(S){return l("var",b(S));}function J(){return l("const",b());}function D(){var aa=z(false),S;if(x("punc","(")){i();S=X(")");}else{S=[];}return F(l("new",aa,S),true);}var z=L(function(S){if(x("operator","new")){i();return D();}if(x("punc")){switch(k.token.value){case"(":i();return F(prog1(u,curry(d,")")),S);case"[":i();return F(T(),S);case"{":i();return F(Z(),S);}K();}if(x("keyword","function")){i();return F(B(false),S);}if(HOP(ATOMIC_START_TOKEN,k.token.type)){var aa=k.token.type=="regexp"?l("regexp",k.token.value[0],k.token.value[1]):l(k.token.type,k.token.value);return F(prog1(aa,i),S);}K();});function X(ab,S,ac){var ad=true,aa=[];while(!x("punc",ab)){if(ad){ad=false;}else{d(",");}if(S&&x("punc",ab)){break;}if(x("punc",",")&&ac){aa.push(["atom","undefined"]);}else{aa.push(u(false));}}i();return aa;}function T(){return l("array",X("]",!M,true));}function Z(){var ac=true,S=[];while(!x("punc","}")){if(ac){ac=false;}else{d(",");}if(!M&&x("punc","}")){break;}var ab=k.token.type;var aa=t();if(ab=="name"&&(aa=="get"||aa=="set")&&!x("punc",":")){S.push([O(),B(false),aa]);}else{d(":");S.push([aa,u(false)]);}}i();return l("object",S);}function t(){switch(k.token.type){case"num":case"string":return prog1(k.token.value,i);}return O();}function O(){switch(k.token.type){case"name":case"operator":case"keyword":case"atom":return prog1(k.token.value,i);default:K();}}function F(aa,S){if(x("punc",".")){i();return F(l("dot",aa,O()),S);}if(x("punc","[")){i();return F(l("sub",aa,prog1(u,curry(d,"]"))),S);}if(S&&x("punc","(")){i();return F(l("call",aa,X(")")),true);}return aa;}function H(S){if(x("operator")&&HOP(UNARY_PREFIX,k.token.value)){return f("unary-prefix",prog1(k.token.value,i),H(S));}var aa=z(S);while(x("operator")&&HOP(UNARY_POSTFIX,k.token.value)&&!k.token.nlb){aa=f("unary-postfix",k.token.value,aa);i();}return aa;}function f(S,ab,aa){if((ab=="++"||ab=="--")&&!G(aa)){h("Invalid use of "+ab+" operator");}return l(S,ab,aa);}function P(ad,ac,S){var ae=x("operator")?k.token.value:null;if(ae&&ae=="in"&&S){ae=null;}var aa=ae!=null?PRECEDENCE[ae]:null;if(aa!=null&&aa>ac){i();var ab=P(H(true),aa,S);return P(l("binary",ae,ad,ab),ac,S);}return ad;}function o(S){return P(H(true),0,S);}function Y(S){var aa=o(S);if(x("operator","?")){i();var ab=u(false);d(":");return l("conditional",aa,ab,u(false,S));}return aa;}function G(S){if(!M){return true;}switch(S[0]+""){case"dot":case"sub":case"new":case"call":return true;case"name":return S[1]!="this";}}function W(S){var aa=Y(S),ab=k.token.value;if(x("operator")&&HOP(ASSIGNMENT,ab)){if(G(aa)){i();return l("assign",ASSIGNMENT[ab],aa,W(S));}h("Invalid assignment");}return aa;}var u=L(function(aa,S){if(arguments.length==0){aa=true;}var ab=W(S);if(aa&&x("punc",",")){i();return l("seq",ab,u(true,S));}return ab;});function j(S){try{++k.in_loop;return S();}finally{--k.in_loop;}}return l("toplevel",(function(S){while(!x("eof")){S.push(v());}return S;})([]));}function curry(b){var a=slice(arguments,1);return function(){return b.apply(this,a.concat(slice(arguments)));};}function prog1(a){if(a instanceof Function){a=a();}for(var b=1,c=arguments.length;--c>0;++b){arguments[b]();}return a;}function array_to_hash(b){var c={};for(var d=0;d<b.length;++d){c[b[d]]=true;}return c;}function slice(b,c){return Array.prototype.slice.call(b,c||0);}function characters(a){return a.split("");}function member(a,c){for(var b=c.length;--b>=0;){if(c[b]===a){return true;}}return false;}function HOP(a,b){return Object.prototype.hasOwnProperty.call(a,b);}var warn=function(){};exports.tokenizer=tokenizer;exports.parse=parse;exports.slice=slice;exports.curry=curry;exports.member=member;exports.array_to_hash=array_to_hash;exports.PRECEDENCE=PRECEDENCE;exports.KEYWORDS_ATOM=KEYWORDS_ATOM;exports.RESERVED_WORDS=RESERVED_WORDS;exports.KEYWORDS=KEYWORDS;exports.ATOMIC_START_TOKEN=ATOMIC_START_TOKEN;exports.OPERATORS=OPERATORS;exports.is_alphanumeric_char=is_alphanumeric_char;exports.set_logger=function(a){warn=a;};var jsp=require("./parse-js"),slice=jsp.slice,member=jsp.member,PRECEDENCE=jsp.PRECEDENCE,OPERATORS=jsp.OPERATORS;function ast_walker(){function g(i){return[this[0],MAP(i,function(k){var j=[k[0]];if(k.length>1){j[1]=b(k[1]);}return j;})];}function f(i){var j=[this[0]];if(i!=null){j.push(MAP(i,b));}return j;}var c={string:function(i){return[this[0],i];},num:function(i){return[this[0],i];},name:function(i){return[this[0],i];},toplevel:function(i){return[this[0],MAP(i,b)];},block:f,splice:f,"var":g,"const":g,"try":function(i,k,j){return[this[0],MAP(i,b),k!=null?[k[0],MAP(k[1],b)]:null,j!=null?MAP(j,b):null];},"throw":function(i){return[this[0],b(i)];},"new":function(j,i){return[this[0],b(j),MAP(i,b)];},"switch":function(j,i){return[this[0],b(j),MAP(i,function(k){return[k[0]?b(k[0]):null,MAP(k[1],b)];})];},"break":function(i){return[this[0],i];},"continue":function(i){return[this[0],i];},conditional:function(j,i,k){return[this[0],b(j),b(i),b(k)];},assign:function(k,i,j){return[this[0],k,b(i),b(j)];},dot:function(i){return[this[0],b(i)].concat(slice(arguments,1));},call:function(j,i){return[this[0],b(j),MAP(i,b)];},"function":function(k,j,i){return[this[0],k,j.slice(),MAP(i,b)];},defun:function(k,j,i){return[this[0],k,j.slice(),MAP(i,b)];},"if":function(i,j,k){return[this[0],b(i),b(j),b(k)];},"for":function(l,i,j,k){return[this[0],b(l),b(i),b(j),b(k)];},"for-in":function(i,j,k,l){return[this[0],b(i),b(j),b(k),b(l)];},"while":function(i,j){return[this[0],b(i),b(j)];},"do":function(i,j){return[this[0],b(i),b(j)];},"return":function(i){return[this[0],b(i)];},binary:function(k,j,i){return[this[0],k,b(j),b(i)];},"unary-prefix":function(j,i){return[this[0],j,b(i)];},"unary-postfix":function(j,i){return[this[0],j,b(i)];},sub:function(j,i){return[this[0],b(j),b(i)];},object:function(i){return[this[0],MAP(i,function(j){return j.length==2?[j[0],b(j[1])]:[j[0],b(j[1]),j[2]];})];},regexp:function(j,i){return[this[0],j,i];},array:function(i){return[this[0],MAP(i,b)];},stat:function(i){return[this[0],b(i)];},seq:function(){return[this[0]].concat(MAP(slice(arguments),b));},label:function(i,j){return[this[0],i,b(j)];},"with":function(i,j){return[this[0],b(i),b(j)];},atom:function(i){return[this[0],i];}};var d={};var a=[];function b(i){if(i==null){return null;}try{a.push(i);var k=i[0];var l=d[k];if(l){var j=l.apply(i,i.slice(1));if(j!=null){return j;}}l=c[k];return l.apply(i,i.slice(1));}finally{a.pop();}}function h(i){if(i==null){return null;}try{a.push(i);return c[i[0]].apply(i,i.slice(1));}finally{a.pop();}}function e(k,j){var n={},m;for(m in k){if(HOP(k,m)){n[m]=d[m];d[m]=k[m];}}var l=j();for(m in n){if(HOP(n,m)){if(!n[m]){delete d[m];}else{d[m]=n[m];}}}return l;}return{walk:b,dive:h,with_walkers:e,parent:function(){return a[a.length-2];},stack:function(){return a;}};}function Scope(a){this.names={};this.mangled={};this.rev_mangled={};this.cname=-1;this.refs={};this.uses_with=false;this.uses_eval=false;this.parent=a;this.children=[];if(a){this.level=a.level+1;a.children.push(this);}else{this.level=0;}}var base54=(function(){var a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_";return function(c){var b="";do{b=a.charAt(c%54)+b;c=Math.floor(c/54);}while(c>0);return b;};})();Scope.prototype={has:function(a){for(var b=this;b;b=b.parent){if(HOP(b.names,a)){return b;}}},has_mangled:function(b){for(var a=this;a;a=a.parent){if(HOP(a.rev_mangled,b)){return a;}}},toJSON:function(){return{names:this.names,uses_eval:this.uses_eval,uses_with:this.uses_with};},next_mangled:function(){for(;;){var a=base54(++this.cname),b;b=this.has_mangled(a);if(b&&this.refs[b.rev_mangled[a]]===b){continue;}b=this.has(a);if(b&&b!==this&&this.refs[a]===b&&!b.has_mangled(a)){continue;}if(HOP(this.refs,a)&&this.refs[a]==null){continue;}if(!is_identifier(a)){continue;}return a;}},set_mangle:function(b,a){this.rev_mangled[a]=b;return this.mangled[b]=a;},get_mangled:function(b,a){if(this.uses_eval||this.uses_with){return b;}var c=this.has(b);if(!c){return b;}if(HOP(c.mangled,b)){return c.mangled[b];}if(!a){return b;}return c.set_mangle(b,c.next_mangled());},references:function(a){return a&&!this.parent||this.uses_with||this.uses_eval||this.refs[a];},define:function(a,b){if(a!=null){if(b=="var"||!HOP(this.names,a)){this.names[a]=b||"var";}return a;}}};function ast_add_scope(b){var e=null;var i=ast_walker(),j=i.walk;var g=[];function h(k){e=new Scope(e);var l=e.body=k();l.scope=e;e=e.parent;return l;}function f(k,l){return e.define(k,l);}function d(k){e.refs[k]=true;}function a(m,l,k){var n=this[0]=="defun";return[this[0],n?f(m,"defun"):m,l,h(function(){if(!n){f(m,"lambda");}MAP(l,function(o){f(o,"arg");});return MAP(k,j);})];}function c(k){return function(l){MAP(l,function(m){f(m[0],k);if(m[1]){d(m[0]);}});};}return h(function(){var k=i.with_walkers({"function":a,defun:a,label:function(m,n){f(m,"label");},"break":function(m){if(m){d(m);}},"continue":function(m){if(m){d(m);}},"with":function(n,o){for(var m=e;m;m=m.parent){m.uses_with=true;}},"var":c("var"),"const":c("const"),"try":function(m,o,n){if(o!=null){return[this[0],MAP(m,j),[f(o[0],"catch"),MAP(o[1],j)],n!=null?MAP(n,j):null];}},name:function(m){if(m=="eval"){g.push(e);}d(m);}},function(){return j(b);});MAP(g,function(m){if(!m.has("eval")){while(m){m.uses_eval=true;m=m.parent;}}});function l(p,n){for(n=p.children.length;--n>=0;){l(p.children[n]);}for(n in p.refs){if(HOP(p.refs,n)){for(var m=p.has(n),o=p;o;o=o.parent){o.refs[n]=m;if(o===m){break;}}}}}l(e);return k;});}function ast_mangle(b,j){var g=ast_walker(),h=g.walk,i;j=j||{};function d(l,k){if(!j.toplevel&&!i.parent){return l;}if(j.except&&member(l,j.except)){return l;}return i.get_mangled(l,k);}function e(k){if(j.defines){if(!i.has(k)){if(HOP(j.defines,k)){return j.defines[k];}}return null;}}function a(n,m,l){var o=this[0]=="defun",k;if(n){if(o){n=d(n);}else{k={};if(!(i.uses_eval||i.uses_with)){n=k[n]=i.next_mangled();}else{k[n]=n;}}}l=c(l.scope,function(){m=MAP(m,function(p){return d(p);});return MAP(l,h);},k);return[this[0],n,m,l];}function c(p,m,l){var k=i;i=p;if(l){for(var o in l){if(HOP(l,o)){p.set_mangle(o,l[o]);}}}for(var o in p.names){if(HOP(p.names,o)){d(o,true);}}var n=m();n.scope=p;i=k;return n;}function f(k){return[this[0],MAP(k,function(l){return[d(l[0]),h(l[1])];})];}return g.with_walkers({"function":a,defun:function(){var k=a.apply(this,arguments);switch(g.parent()[0]){case"toplevel":case"function":case"defun":return MAP.at_top(k);}return k;},label:function(k,l){return[this[0],d(k),h(l)];},"break":function(k){if(k){return[this[0],d(k)];}},"continue":function(k){if(k){return[this[0],d(k)];}},"var":f,"const":f,name:function(k){return e(k)||[this[0],d(k)];},"try":function(k,m,l){return[this[0],MAP(k,h),m!=null?[d(m[0]),MAP(m[1],h)]:null,l!=null?MAP(l,h):null];},toplevel:function(k){var l=this;return c(l.scope,function(){return[l[0],MAP(k,h)];});}},function(){return h(ast_add_scope(b));});}var warn=function(){};function best_of(b,a){return gen_code(b).length>gen_code(a[0]=="stat"?a[1]:a).length?a:b;}function last_stat(a){if(a[0]=="block"&&a[1]&&a[1].length>0){return a[1][a[1].length-1];}return a;}function aborts(a){if(a){switch(last_stat(a)[0]){case"return":case"break":case"continue":case"throw":return true;}}}function boolean_expr(a){return((a[0]=="unary-prefix"&&member(a[1],["!","delete"]))||(a[0]=="binary"&&member(a[1],["in","instanceof","==","!=","===","!==","<","<=",">=",">"]))||(a[0]=="binary"&&member(a[1],["&&","||"])&&boolean_expr(a[2])&&boolean_expr(a[3]))||(a[0]=="conditional"&&boolean_expr(a[2])&&boolean_expr(a[3]))||(a[0]=="assign"&&a[1]===true&&boolean_expr(a[3]))||(a[0]=="seq"&&boolean_expr(a[a.length-1])));}function empty(a){return !a||(a[0]=="block"&&(!a[1]||a[1].length==0));}function is_string(a){return(a[0]=="string"||a[0]=="unary-prefix"&&a[1]=="typeof"||a[0]=="binary"&&a[1]=="+"&&(is_string(a[2])||is_string(a[3])));}var when_constant=(function(){var a={};function b(e){switch(e[0]){case"string":case"num":return e[1];case"name":case"atom":switch(e[1]){case"true":return true;case"false":return false;case"null":return null;}break;case"unary-prefix":switch(e[1]){case"!":return !b(e[2]);case"typeof":return typeof b(e[2]);case"~":return ~b(e[2]);case"-":return -b(e[2]);case"+":return +b(e[2]);}break;case"binary":var d=e[2],c=e[3];switch(e[1]){case"&&":return b(d)&&b(c);case"||":return b(d)||b(c);case"|":return b(d)|b(c);case"&":return b(d)&b(c);case"^":return b(d)^b(c);case"+":return b(d)+b(c);case"*":return b(d)*b(c);case"/":return b(d)/b(c);case"%":return b(d)%b(c);case"-":return b(d)-b(c);case"<<":return b(d)<<b(c);case">>":return b(d)>>b(c);case">>>":return b(d)>>>b(c);case"==":return b(d)==b(c);case"===":return b(d)===b(c);case"!=":return b(d)!=b(c);case"!==":return b(d)!==b(c);case"<":return b(d)<b(c);case"<=":return b(d)<=b(c);case">":return b(d)>b(c);case">=":return b(d)>=b(c);case"in":return b(d) in b(c);case"instanceof":return b(d) instanceof b(c);}}throw a;}return function(g,j,i){try{var h=b(g),c;switch(typeof h){case"string":c=["string",h];break;case"number":c=["num",h];break;case"boolean":c=["name",String(h)];break;default:throw new Error("Can't handle constant of type: "+(typeof h));}return j.call(g,c,h);}catch(e){if(e===a){if(g[0]=="binary"&&(g[1]=="==="||g[1]=="!==")&&((is_string(g[2])&&is_string(g[3]))||(boolean_expr(g[2])&&boolean_expr(g[3])))){g[1]=g[1].substr(0,2);}else{if(i&&g[0]=="binary"&&(g[1]=="||"||g[1]=="&&")){try{var d=b(g[2]);g=((g[1]=="&&"&&(d?g[3]:d))||(g[1]=="||"&&(d?d:g[3]))||g);}catch(f){}}}return i?i.call(g,g):null;}else{throw e;}}};})();function warn_unreachable(a){if(!empty(a)){warn("Dropping unreachable code: "+gen_code(a,true));}}function prepare_ifs(a){var d=ast_walker(),c=d.walk;function f(g){g=MAP(g,c);for(var l=0;l<g.length;++l){var o=g[l];if(o[0]!="if"){continue;}if(o[3]&&c(o[3])){continue;}var k=c(o[2]);if(!aborts(k)){continue;}var j=c(o[1]);var n=g.slice(l+1);var m=n.length==1?n[0]:["block",n];var h=g.slice(0,l).concat([[o[0],j,k,m]]);return f(h);}return g;}function e(i,h,g){g=f(g);return[this[0],i,h,g];}function b(g){return[this[0],g!=null?f(g):null];}return d.with_walkers({defun:e,"function":e,block:b,splice:b,toplevel:function(g){return[this[0],f(g)];},"try":function(g,i,h){return[this[0],f(g),i!=null?[i[0],f(i[1])]:null,h!=null?f(h):null];}},function(){return c(a);});}function for_side_effects(a,h){var f=ast_walker(),g=f.walk;var d={},c={};function e(){throw d;}function i(){throw c;}function j(){return h.call(this,this,f,e,i);}function b(k){if(k=="++"||k=="--"){return j.apply(this,arguments);}}return f.with_walkers({"try":j,"throw":j,"return":j,"new":j,"switch":j,"break":j,"continue":j,assign:j,call:j,"if":j,"for":j,"for-in":j,"while":j,"do":j,"return":j,"unary-prefix":b,"unary-postfix":b,defun:j},function(){while(true){try{g(a);break;}catch(k){if(k===d){break;}if(k===c){continue;}throw k;}}});}function ast_lift_variables(a){var c=ast_walker(),b=c.walk,d;function f(i,j){var h=d;d=j;i=MAP(i,b);var l={},k=MAP(j.names,function(n,m){if(n!="var"){return MAP.skip;}if(!j.references(m)){return MAP.skip;}l[m]=true;return[m];});if(k.length>0){for_side_effects(["block",i],function(m,t,r,o){if(m[0]=="assign"&&m[1]===true&&m[2][0]=="name"&&HOP(l,m[2][1])){for(var q=k.length;--q>=0;){if(k[q][0]==m[2][1]){if(k[q][1]){r();}k[q][1]=m[3];k.push(k.splice(q,1)[0]);break;}}var s=t.parent();if(s[0]=="seq"){var n=s[2];n.unshift(0,s.length);s.splice.apply(s,n);}else{if(s[0]=="stat"){s.splice(0,s.length,"block");}else{r();}}o();}r();});i.unshift(["var",k]);}d=h;return i;}function g(h){var j=null;for(var k=h.length;--k>=0;){var l=h[k];if(!l[1]){continue;}l=["assign",true,["name",l[0]],l[1]];if(j==null){j=l;}else{j=["seq",l,j];}}if(j==null){if(c.parent()[0]=="for-in"){return["name",h[0][0]];}return MAP.skip;}return["stat",j];}function e(h){return[this[0],f(h,this.scope)];}return c.with_walkers({"function":function(k,j,h){for(var l=j.length;--l>=0&&!h.scope.references(j[l]);){j.pop();}if(!h.scope.references(k)){k=null;}return[this[0],k,j,f(h,h.scope)];},defun:function(k,j,h){if(!d.references(k)){return MAP.skip;}for(var l=j.length;--l>=0&&!h.scope.references(j[l]);){j.pop();}return[this[0],k,j,f(h,h.scope)];},"var":g,toplevel:e},function(){return b(ast_add_scope(a));});}function ast_squeeze(b,n){n=defaults(n,{make_seqs:true,dead_code:true,no_warnings:false,keep_comps:true});var i=ast_walker(),j=i.walk,m;function f(s){var q=["unary-prefix","!",s];switch(s[0]){case"unary-prefix":return s[1]=="!"&&boolean_expr(s[2])?s[2]:q;case"seq":s=slice(s);s[s.length-1]=f(s[s.length-1]);return s;case"conditional":return best_of(q,["conditional",s[1],f(s[2]),f(s[3])]);case"binary":var r=s[1],p=s[2],o=s[3];if(!n.keep_comps){switch(r){case"<=":return["binary",">",p,o];case"<":return["binary",">=",p,o];case">=":return["binary","<",p,o];case">":return["binary","<=",p,o];}}switch(r){case"==":return["binary","!=",p,o];case"!=":return["binary","==",p,o];case"===":return["binary","!==",p,o];case"!==":return["binary","===",p,o];case"&&":return best_of(q,["binary","||",f(p),f(o)]);case"||":return best_of(q,["binary","&&",f(p),f(o)]);}break;}return q;}function d(r,p,q){var o=function(){if(r[0]=="unary-prefix"&&r[1]=="!"){return q?["conditional",r[2],q,p]:["binary","||",r[2],p];}else{return q?best_of(["conditional",r,p,q],["conditional",f(r),q,p]):["binary","&&",r,p];}};return when_constant(r,function(s,t){warn_unreachable(t?q:p);return(t?p:q);},o);}function c(r,p){var o=m;m=r;var q=p();q.scope=r;m=o;return q;}function g(o){if(o!=null&&o[0]=="block"&&o[1]){if(o[1].length==1){o=o[1][0];}else{if(o[1].length==0){o=["block"];}}}return o;}function a(q,p,o){var r=this[0]=="defun";o=c(o.scope,function(){var s=e(o,"lambda");if(!r&&q&&!m.references(q)){q=null;}return s;});return[this[0],q,p,o];}function e(o,p){o=MAP(o,j);o=o.reduce(function(q,r){if(r[0]=="block"){if(r[1]){q.push.apply(q,r[1]);}}else{q.push(r);}return q;},[]);o=(function(q,r){o.forEach(function(s){if(r&&((s[0]=="var"&&r[0]=="var")||(s[0]=="const"&&r[0]=="const"))){r[1]=r[1].concat(s[1]);}else{q.push(s);r=s;}});return q;})([]);if(n.dead_code){o=(function(r,q){o.forEach(function(s){if(q){if(s[0]=="function"||s[0]=="defun"){r.push(s);}else{if(s[0]=="var"||s[0]=="const"){if(!n.no_warnings){warn("Variables declared in unreachable code");}s[1]=MAP(s[1],function(t){if(t[1]&&!n.no_warnings){warn_unreachable(["assign",true,["name",t[0]],t[1]]);}return[t[0]];});r.push(s);}else{if(!n.no_warnings){warn_unreachable(s);}}}}else{r.push(s);if(member(s[0],["return","throw","break","continue"])){q=true;}}});return r;})([]);}if(n.make_seqs){o=(function(q,r){o.forEach(function(s){if(r&&r[0]=="stat"&&s[0]=="stat"){r[1]=["seq",r[1],s[1]];}else{q.push(s);r=s;}});if(q.length>=2&&q[q.length-2][0]=="stat"&&(q[q.length-1][0]=="return"||q[q.length-1][0]=="throw")&&q[q.length-1][1]){q.splice(q.length-2,2,[q[q.length-1][0],["seq",q[q.length-2][1],q[q.length-1][1]]]);}return q;})([]);}return o;}function l(q,o,p){return when_constant(q,function(r,s){if(s){o=j(o);warn_unreachable(p);return o||["block"];}else{p=j(p);warn_unreachable(o);return p||["block"];}},function(){return h(q,o,p);});}function h(r,p,q){r=j(r);p=j(p);q=j(q);if(empty(p)){r=f(r);p=q;q=null;}else{if(empty(q)){q=null;}else{(function(){var t=gen_code(r);var v=f(r);var s=gen_code(v);if(s.length<t.length){var u=p;p=q;q=u;r=v;}})();}}if(empty(q)&&empty(p)){return["stat",r];}var o=["if",r,p,q];if(p[0]=="if"&&empty(p[3])&&empty(q)){o=best_of(o,j(["if",["binary","&&",r,p[1]],p[2]]));}else{if(p[0]=="stat"){if(q){if(q[0]=="stat"){o=best_of(o,["stat",d(r,p[1],q[1])]);}}else{o=best_of(o,["stat",d(r,p[1])]);}}else{if(q&&p[0]==q[0]&&(p[0]=="return"||p[0]=="throw")&&p[1]&&q[1]){o=best_of(o,[p[0],d(r,p[1],q[1])]);}else{if(q&&aborts(p)){o=[["if",r,p]];if(q[0]=="block"){if(q[1]){o=o.concat(q[1]);}}else{o.push(q);}o=j(["block",o]);}else{if(p&&aborts(q)){o=[["if",f(r),q]];if(p[0]=="block"){if(p[1]){o=o.concat(p[1]);}}else{o.push(p);}o=j(["block",o]);}}}}}return o;}function k(p,o){return when_constant(p,function(q,r){if(!r){warn_unreachable(o);return["block"];}else{return["for",null,null,null,j(o)];}});}return i.with_walkers({sub:function(q,p){if(p[0]=="string"){var o=p[1];if(is_identifier(o)){return["dot",j(q),o];}else{if(/^[1-9][0-9]*$/.test(o)||o==="0"){return["sub",j(q),["num",parseInt(o,10)]];}}}},"if":l,toplevel:function(o){return["toplevel",c(this.scope,function(){return e(o);})];},"switch":function(q,o){var p=o.length-1;return["switch",j(q),MAP(o,function(s,r){var u=e(s[1]);if(r==p&&u.length>0){var t=u[u.length-1];if(t[0]=="break"&&!t[1]){u.pop();}}return[s[0]?j(s[0]):null,u];})];},"function":a,defun:a,block:function(o){if(o){return g(["block",e(o)]);}},binary:function(s,p,o){return when_constant(["binary",s,j(p),j(o)],function r(t){return best_of(j(t),this);},function q(){return function(){if(s!="=="&&s!="!="){return;}var t=j(p),u=j(o);if(t&&t[0]=="unary-prefix"&&t[1]=="!"&&t[2][0]=="num"){p=["num",+!t[2][1]];}else{if(u&&u[0]=="unary-prefix"&&u[1]=="!"&&u[2][0]=="num"){o=["num",+!u[2][1]];}}return["binary",s,p,o];}()||this;});},conditional:function(q,o,p){return d(j(q),j(o),j(p));},"try":function(o,q,p){return["try",e(o),q!=null?[q[0],e(q[1])]:null,p!=null?e(p):null];},"unary-prefix":function(q,p){p=j(p);var o=["unary-prefix",q,p];if(q=="!"){o=best_of(o,f(p));}return when_constant(o,function(r,s){return j(r);},function(){return o;});},name:function(o){switch(o){case"true":return["unary-prefix","!",["num",0]];case"false":return["unary-prefix","!",["num",1]];}},"while":k,assign:function(r,o,q){o=j(o);q=j(q);var p=["+","-","/","*","%",">>","<<",">>>","|","^","&"];if(r===true&&o[0]==="name"&&q[0]==="binary"&&~p.indexOf(q[1])&&q[2][0]==="name"&&q[2][1]===o[1]){return[this[0],q[1],o,q[3]];}return[this[0],r,o,q];}},function(){for(var o=0;o<2;++o){b=prepare_ifs(b);b=ast_add_scope(b);b=j(b);}return b;});}var DOT_CALL_NO_PARENS=jsp.array_to_hash(["name","array","object","string","dot","sub","call","regexp","defun"]);function make_string(d,a){var c=0,b=0;d=d.replace(/[\\\b\f\n\r\t\x22\x27\u2028\u2029\0]/g,function(e){switch(e){case"\\":return"\\\\";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";case'"':++c;return'"';case"'":++b;return"'";case"\0":return"\\0";}return e;});if(a){d=to_ascii(d);}if(c>b){return"'"+d.replace(/\x27/g,"\\'")+"'";}else{return'"'+d.replace(/\x22/g,'\\"')+'"';}}function to_ascii(a){return a.replace(/[\u0080-\uffff]/g,function(b){var c=b.charCodeAt(0).toString(16);while(c.length<4){c="0"+c;}return"\\u"+c;});}var SPLICE_NEEDS_BRACKETS=jsp.array_to_hash(["if","while","do","for","for-in","with"]);function gen_code(h,d){d=defaults(d,{indent_start:0,indent_level:4,quote_keys:false,space_colon:false,beautify:false,ascii_only:false,inline_script:false});var m=!!d.beautify;var a=0,s=m?"\n":"",y=m?" ":"";function u(A){var w=make_string(A,d.ascii_only);if(d.inline_script){w=w.replace(/<\x2fscript([>/\t\n\f\r ])/gi,"<\\/script$1");}return w;}function j(w){w=w.toString();if(d.ascii_only){w=to_ascii(w);}return w;}function n(w){if(w==null){w="";}if(m){w=repeat_string(" ",d.indent_start+a*d.indent_level)+w;}return w;}function v(w,A){if(A==null){A=1;}a+=A;try{return w.apply(null,slice(arguments,1));}finally{a-=A;}}function o(A){if(m){return A.join(" ");}var w=[];for(var B=0;B<A.length;++B){var C=A[B+1];w.push(A[B]);if(C&&((/[a-z0-9_\x24]$/i.test(A[B].toString())&&/^[a-z0-9_\x24]/i.test(C.toString()))||(/[\+\-]$/.test(A[B].toString())&&/^[\+\-]/.test(C.toString())))){w.push(" ");}}return w.join("");}function x(w){return w.join(","+y);}function f(B){var C=c(B);for(var w=1;w<arguments.length;++w){var A=arguments[w];if((A instanceof Function&&A(B))||B[0]==A){return"("+C+")";}}return C;}function k(A){if(A.length==1){return A[0];}if(A.length==2){var w=A[1];A=A[0];return A.length<=w.length?A:w;}return k([A[0],k(A.slice(1))]);}function p(C){if(C[0]=="function"||C[0]=="object"){var w=slice(l.stack()),A=w.pop(),B=w.pop();while(B){if(B[0]=="stat"){return true;}if(((B[0]=="seq"||B[0]=="call"||B[0]=="dot"||B[0]=="sub"||B[0]=="conditional")&&B[1]===A)||((B[0]=="binary"||B[0]=="assign"||B[0]=="unary-postfix")&&B[2]===A)){A=B;B=w.pop();}else{return false;}}}return !HOP(DOT_CALL_NO_PARENS,C[0]);}function b(B){var C=B.toString(10),A=[C.replace(/^0\./,".")],w;if(Math.floor(B)===B){if(B>=0){A.push("0x"+B.toString(16).toLowerCase(),"0"+B.toString(8));}else{A.push("-0x"+(-B).toString(16).toLowerCase(),"-0"+(-B).toString(8));}if((w=/^(.*?)(0+)$/.exec(B))){A.push(w[1]+"e"+w[2].length);}}else{if((w=/^0?\.(0+)(.*)$/.exec(B))){A.push(w[2]+"e-"+(w[1].length+w[2].length),C.substr(C.indexOf(".")));}}return k(A);}var l=ast_walker();var c=l.walk;return l.with_walkers({string:u,num:b,name:j,toplevel:function(w){return t(w).join(s+s);},splice:function(w){var A=l.parent();if(HOP(SPLICE_NEEDS_BRACKETS,A)){return r.apply(this,arguments);}else{return MAP(t(w,true),function(B,C){return C>0?n(B):B;}).join(s);}},block:r,"var":function(w){return"var "+x(MAP(w,z))+";";},"const":function(w){return"const "+x(MAP(w,z))+";";},"try":function(B,w,C){var A=["try",r(B)];if(w){A.push("catch","("+w[0]+")",r(w[1]));}if(C){A.push("finally",r(C));}return o(A);},"throw":function(w){return o(["throw",c(w)])+";";},"new":function(A,w){w=w.length>0?"("+x(MAP(w,function(B){return f(B,"seq");}))+")":"";return o(["new",f(A,"seq","binary","conditional","assign",function(E){var B=ast_walker(),D={};try{B.with_walkers({call:function(){throw D;},"function":function(){return this;}},function(){B.walk(E);});}catch(C){if(C===D){return true;}throw C;}})+w]);},"switch":function(A,w){return o(["switch","("+c(A)+")",q(w)]);},"break":function(A){var w="break";if(A!=null){w+=" "+j(A);}return w+";";},"continue":function(A){var w="continue";if(A!=null){w+=" "+j(A);}return w+";";},conditional:function(B,A,w){return o([f(B,"assign","seq","conditional"),"?",f(A,"seq"),":",f(w,"seq")]);},assign:function(B,w,A){if(B&&B!==true){B+="=";}else{B="=";}return o([c(w),B,f(A,"seq")]);},dot:function(B){var w=c(B),A=1;if(B[0]=="num"){if(!/\./.test(B[1])){w+=".";}}else{if(p(B)){w="("+w+")";}}while(A<arguments.length){w+="."+j(arguments[A++]);}return w;},call:function(A,w){var B=c(A);if(B.charAt(0)!="("&&p(A)){B="("+B+")";}return B+"("+x(MAP(w,function(C){return f(C,"seq");}))+")";},"function":i,defun:i,"if":function(C,B,A){var w=["if","("+c(C)+")",A?g(B):c(B)];if(A){w.push("else",c(A));}return o(w);},"for":function(E,B,C,D){var A=["for"];E=(E!=null?c(E):"").replace(/;*\s*$/,";"+y);B=(B!=null?c(B):"").replace(/;*\s*$/,";"+y);C=(C!=null?c(C):"").replace(/;*\s*$/,"");var w=E+B+C;if(w=="; ; "){w=";;";}A.push("("+w+")",c(D));return o(A);},"for-in":function(w,A,B,C){return o(["for","("+(w?c(w).replace(/;+$/,""):c(A)),"in",c(B)+")",c(C)]);},"while":function(A,w){return o(["while","("+c(A)+")",c(w)]);},"do":function(A,w){return o(["do",c(w),"while","("+c(A)+")"])+";";},"return":function(A){var w=["return"];if(A!=null){w.push(c(A));}return o(w)+";";},binary:function(A,w,C){var D=c(w),B=c(C);if(member(w[0],["assign","conditional","seq"])||w[0]=="binary"&&PRECEDENCE[A]>PRECEDENCE[w[1]]||w[0]=="function"&&p(this)){D="("+D+")";}if(member(C[0],["assign","conditional","seq"])||C[0]=="binary"&&PRECEDENCE[A]>=PRECEDENCE[C[1]]&&!(C[1]==A&&member(A,["&&","||","*"]))){B="("+B+")";}else{if(!m&&d.inline_script&&(A=="<"||A=="<<")&&C[0]=="regexp"&&/^script/i.test(C[1])){B=" "+B;}}return o([D,A,B]);},"unary-prefix":function(w,A){var B=c(A);if(!(A[0]=="num"||(A[0]=="unary-prefix"&&!HOP(OPERATORS,w+A[1]))||!p(A))){B="("+B+")";}return w+(jsp.is_alphanumeric_char(w.charAt(0))?" ":"")+B;},"unary-postfix":function(w,A){var B=c(A);if(!(A[0]=="num"||(A[0]=="unary-postfix"&&!HOP(OPERATORS,w+A[1]))||!p(A))){B="("+B+")";}return B+w;},sub:function(B,w){var A=c(B);if(p(B)){A="("+A+")";}return A+"["+c(w)+"]";},object:function(A){var B=p(this);if(A.length==0){return B?"({})":"{}";}var w="{"+s+v(function(){return MAP(A,function(D){if(D.length==3){return n(i(D[0],D[1][2],D[1][3],D[2]));}var C=D[0],E=f(D[1],"seq");if(d.quote_keys){C=u(C);}else{if((typeof C=="number"||!m&&+C+""==C)&&parseFloat(C)>=0){C=b(+C);}else{if(!is_identifier(C)){C=u(C);}}}return n(o(m&&d.space_colon?[C,":",E]:[C+":",E]));}).join(","+s);})+s+n("}");return B?"("+w+")":w;},regexp:function(A,w){return"/"+A+"/"+w;},array:function(w){if(w.length==0){return"[]";}return o(["[",x(MAP(w,function(B,A){if(!m&&B[0]=="atom"&&B[1]=="undefined"){return A===w.length-1?",":"";}return f(B,"seq");})),"]"]);},stat:function(w){return c(w).replace(/;*\s*$/,";");},seq:function(){return x(MAP(slice(arguments),c));},label:function(w,A){return o([j(w),":",c(A)]);},"with":function(w,A){return o(["with","("+c(w)+")",c(A)]);},atom:function(w){return j(w);}},function(){return c(h);});function g(B){if(B==null){return";";}if(B[0]=="do"){return r([B]);}var w=B;while(true){var A=w[0];if(A=="if"){if(!w[3]){return c(["block",[B]]);}w=w[3];}else{if(A=="while"||A=="do"){w=w[2];}else{if(A=="for"||A=="for-in"){w=w[4];}else{break;}}}}return c(B);}function i(D,C,w,A){var B=A||"function";if(D){B+=" "+j(D);}B+="("+x(MAP(C,j))+")";B=o([B,r(w)]);return p(this)?"("+B+")":B;}function e(w){switch(w[0]){case"with":case"while":return empty(w[2]);case"for":case"for-in":return empty(w[4]);case"if":if(empty(w[2])&&!w[3]){return true;}if(w[3]){if(empty(w[3])){return true;}return e(w[3]);}return e(w[2]);}}function t(A,F){for(var w=[],E=A.length-1,B=0;B<=E;++B){var C=A[B];var D=c(C);if(D!=";"){if(!m&&B==E&&!e(C)){D=D.replace(/;+\s*$/,"");}w.push(D);}}return F?w:MAP(w,n);}function q(w){var A=w.length;if(A==0){return"{}";}return"{"+s+MAP(w,function(D,C){var B=D[1].length>0,E=v(function(){return n(D[0]?o(["case",c(D[0])+":"]):"default:");},0.5)+(B?s+v(function(){return t(D[1]).join(s);}):"");if(!m&&B&&C<A-1){E+=";";}return E;}).join(s)+s+n("}");}function r(w){if(!w){return";";}if(w.length==0){return"{}";}return"{"+s+v(function(){return t(w).join(s);})+s+n("}");}function z(A){var w=A[0],B=A[1];if(B!=null){w=o([j(w),"=",f(B,"seq")]);}return w;}}function split_lines(b,a){var c=[0];jsp.parse(function(){var e=jsp.tokenizer(b);var h=0;var i;function d(j){return j.pos-h;}function g(j){h=j.pos;c.push(h);}function f(){var j=e.apply(this,arguments);out:{if(i){if(i.type=="keyword"){break out;}}if(d(j)>a){switch(j.type){case"keyword":case"atom":case"name":case"punc":g(j);break out;}}}i=j;return j;}f.context=function(){return e.context.apply(this,arguments);};return f;}());return c.map(function(e,d){return b.substring(e,c[d+1]||b.length);}).join("\n");}function repeat_string(c,a){if(a<=0){return"";}if(a==1){return c;}var b=repeat_string(c,a>>1);b+=b;if(a&1){b+=c;}return b;}function defaults(c,a){var b={};if(c===true){c={};}for(var d in a){if(HOP(a,d)){b[d]=(c&&HOP(c,d))?c[d]:a[d];}}return b;}function is_identifier(a){return/^[a-z_$][a-z0-9_$]*$/i.test(a)&&a!="this"&&!HOP(jsp.KEYWORDS_ATOM,a)&&!HOP(jsp.RESERVED_WORDS,a)&&!HOP(jsp.KEYWORDS,a);}function HOP(a,b){return Object.prototype.hasOwnProperty.call(a,b);}var MAP;(function(){MAP=function(d,h,l){var e=[],j=[],g;function k(){var f=h.call(l,d[g],g);if(f instanceof a){f=f.v;if(f instanceof c){j.push.apply(j,f.v);}else{j.push(f);}}else{if(f!=b){if(f instanceof c){e.push.apply(e,f.v);}else{e.push(f);}}}}if(d instanceof Array){for(g=0;g<d.length;++g){k();}}else{for(g in d){if(HOP(d,g)){k();}}}return j.concat(e);};MAP.at_top=function(d){return new a(d);};MAP.splice=function(d){return new c(d);};var b=MAP.skip={};function a(d){this.v=d;}function c(d){this.v=d;}})();exports.ast_walker=ast_walker;exports.ast_mangle=ast_mangle;exports.ast_squeeze=ast_squeeze;exports.ast_lift_variables=ast_lift_variables;exports.gen_code=gen_code;exports.ast_add_scope=ast_add_scope;exports.set_logger=function(a){warn=a;};exports.make_string=make_string;exports.split_lines=split_lines;exports.MAP=MAP;exports.ast_squeeze_more=require("./squeeze-more").ast_squeeze_more;